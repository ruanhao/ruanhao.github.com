<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Cli | Hao Ruan's 部落格]]></title>
  <link href="http:///blog/categories/cli/atom.xml" rel="self"/>
  <link href="http:///"/>
  <updated>2017-08-02T22:33:43+08:00</updated>
  <id>http:///</id>
  <author>
    <name><![CDATA[Hao Ruan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ssh]]></title>
    <link href="http:///blog/2016/09/14/ssh/"/>
    <updated>2016-09-14T14:35:45+08:00</updated>
    <id>http:///blog/2016/09/14/ssh</id>
    <content type="html"><![CDATA[<h2 id="remote-forward">Remote Forward</h2>

<p><code>ssh -N -f -R &lt;remote-port&gt;:&lt;dest-host&gt;:&lt;dest-host-port&gt; user@remote-host</code></p>

<p><img src="/images/examples/ssh.png"></p>

<p>&lt;remote-port&gt; 监听在 localhost 上，如需要被外部访问，可以在 remote-host 上再添加一个端口转发:</p>

<p><code>socat TCP4-LISTEN:8888,reuseaddr,fork TCP4:127.0.0.1:&lt;remote-port&gt; &amp;</code></p>

<p>这样外部可以通过 &lt;remote-host&gt;:8888 访问 &lt;dest-host&gt;:&lt;dest-host-port&gt;</p>

<p><a href="http://www.ruanyifeng.com/blog/2011/12/ssh_port_forwarding.html">Ref1</a></p>

<p><a href="http://www.liugj.com/2013/04/SSH-port-forwarding/">Ref2</a></p>

<h2 id="misc">Misc</h2>

<ul>
  <li>在远程机器上运行一段脚本（不必把脚本拷贝到远程机器上)</li>
</ul>

<p><code>ssh user@server bash &lt; /path/to/local/script.sh</code></p>

<ul>
  <li>比较一个远程文件个一个本地文件</li>
</ul>

<p><code>ssh user@host cat /path/to/remotefile | diff /path/to/localfile -</code></p>

<ul>
  <li>cat 文件</li>
</ul>

<p><code>ssh user@host 'mkdir -p .ssh &amp;&amp; cat &gt;&gt; .ssh/authorized_keys' &lt; ~/.ssh/id_rsa.pub </code></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dig]]></title>
    <link href="http:///blog/2016/06/24/dig/"/>
    <updated>2016-06-24T13:27:49+08:00</updated>
    <id>http:///blog/2016/06/24/dig</id>
    <content type="html"><![CDATA[<h2 id="section">查询域名过程</h2>

<p><code>bash
dig blog.ruan.host
</code></p>

<p><img src="/images/examples/dig.png"></p>

<ul>
  <li>HEADER</li>
</ul>

<p>查询参数和统计</p>

<ul>
  <li>QUESTION SECTION</li>
</ul>

<p>查询 <strong>blog.ruan.host</strong> 的 A 记录</p>

<ul>
  <li>ANSWER SECTION</li>
</ul>

<p>DNS 服务器的答复，508 是 TTL 值，表示 508 秒内不需要再查询</p>

<ul>
  <li>AUTHORITY SECTION</li>
</ul>

<p>显示 NAME SERVER (NS) 记录，即哪些服务器负责管理 <strong>fastlylb.net.</strong> 的 DNS 记录，
可以向任一台服务器查询 <strong>prod.github.map.fastlylb.net.</strong> 的 IP 地址</p>

<ul>
  <li>ADDITIONAL SECTION</li>
</ul>

<p>显示域名服务器的 IP 地址</p>

<h2 id="dns-">指定 DNS 服务器查询</h2>

<p>本机 DNS 服务器的 IP 地址保存在 <code>/etc/resolv.conf</code></p>

<p>也可以指定具体的服务器查询</p>

<p><code>bash
dig @8.8.8.8 blog.ruan.host
</code></p>

<h2 id="section-1">域名层级</h2>

<p><blockquote><p>HOST.SLD.TLD.root<br/>SLD :: second-level domain<br/>TLD :: top-level domain</p></blockquote></p>

<p><a href="http://www.iana.org/domains/root/db">顶级域名列表</a></p>

<h2 id="section-2">显示分级查询过程</h2>

<p><code>bash
dig +trace blog.ruan.host
</code></p>

<h2 id="ns-">单独查询每一级域名的 NS 记录</h2>

<p>``` bash
dig ns com.
dig ns host.
dig ns ruan.host.</p>

<p>dig +short ns com.
dig +short ns ruan.host.
```</p>

<h2 id="section-3">反向查询</h2>

<p><code>bash
dig -x 128.199.183.19
</code></p>

]]></content>
  </entry>
  
</feed>
