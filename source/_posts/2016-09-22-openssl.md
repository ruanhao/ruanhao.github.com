---
layout: post
title: "openssl"
date: 2016-09-22 10:22:15 +0800
comments: true
categories: cli
---

## 制作自签署证书步骤

自签署证书一般作为 CA 的证书，普通的证书一般由 CA 来签署，也可以按照该步骤制作自签署的普通证书（将自身作为 CA ）

* <1> 生成密钥

```
openssl genrsa 2048 >ca.key.pem ## 生成2048位私钥
openssl rsa -in ca.key.pem -pubout ## 查看公钥
```

* <2> 生成自签署证书

```
openssl req -new -x509 -key ca.key.pem -out ca.cert.pem -days 365 ## -x509 表示生成自签名证书
openssl x509 -text -in cacert.pem ## 查看证书内容
```


## 签署证书步骤

* <1> 生成 csr

`openssl req -new -key webserver.key -out webserver.csr`

* <2> 签署 csr

`openssl ca -in webserver.csr -out webserver.crt ## 需先部署好 openssl 的 CA 证书`

## 使用 openssl 加解密

* <1> 加密

`openssl enc -des3 -a -in ./test-cipher -out test-cipher.des3`

* <2> 解密

`openssl enc -des3 -d -a -in ./test-cipher.des3 -out test-cipher`


## 使用 openssl 生成随机字符串

`openssl rand -hex 10`

## 格式转换

* pksc1 => pksc8

```
openssl pkcs8 -topk8 -inform pem -in cakey.pem -outform pem -nocrypt -out cakey.pkcs8.pem
```

* pem => pksc12

`openssl pkcs12 -export -in ./client.crt -inkey ./client.key -out client.p12`